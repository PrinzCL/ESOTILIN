DECLARE
   CURSOR c_comuna IS
      SELECT nombre_comuna comuna
      FROM comuna;

   CURSOR c_socio (p_nombre_comuna VARCHAR2) IS
      SELECT s.pnombre nombre
      FROM socio s
      INNER JOIN comuna c ON s.cod_comuna = c.cod_comuna
                           AND s.cod_provincia = c.cod_provincia
                           AND s.cod_region = c.cod_region
      WHERE c.nombre_comuna = p_nombre_comuna;

   cantidad_personas NUMBER;
   
BEGIN
   FOR r_comuna IN c_comuna LOOP
      cantidad_personas := 0;
      FOR r_socio IN c_socio(r_comuna.comuna) LOOP
         dbms_output.put_line('--------------');
         dbms_output.put_line('Nombre: ' || r_socio.nombre);
         dbms_output.put_line('Comuna: ' || r_comuna.comuna);
         cantidad_personas := cantidad_personas + 1; -- Suma la cantidad de personas en la comuna
      END LOOP;
      dbms_output.put_line('Total de personas en ' || r_comuna.comuna || ': ' || cantidad_personas); -- Imprime el total de personas por comuna
   END LOOP;
END;
